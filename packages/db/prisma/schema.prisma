
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User{
  id              Int         @id @default(autoincrement())
  username        String      @unique
  password        String      
  Avatar          String      @default("")
  points          Int         @default(0)
  createdAt       DateTime    @default(now())
  wins            Int         @default(0)
  losses          Int         @default(0)
  gameAsUser1     Game[]      @relation("user1")
  gameAsUser2     Game[]      @relation("user2")
  winsrel         Verdict[]   @relation("win")
  losrel          Verdict[]   @relation("lose")
}

model Game{
  id              String      @id  @default(uuid())
  playedAt        DateTime    @default(now())
  user1           User        @relation("user1",fields: [userId1],references: [id])
  user2           User        @relation("user2",fields: [userId2],references: [id])
  userId1         Int
  userId2         Int
  moves           Move[]
  gameVerdict     Verdict?
}

model Move{
  id              Int         @id @default(autoincrement())
  move            String      
  game            Game        @relation(fields: [gameId],references: [id])       
  gameId          String
  createdAt       DateTime    @default(now())
}

model Verdict{
  id             Int          @id @default(autoincrement())
  gameId         String       @unique
  winnerId       Int       
  loserId        Int
  winner         User         @relation("win",fields: [winnerId],references: [id])
  loser          User         @relation("lose",fields: [loserId],references: [id])
  gameWon        Game         @relation(fields: [gameId],references: [id])
}